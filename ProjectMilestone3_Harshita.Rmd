---
title: "ProjectMilestone3"
author: "Harshita Narayanan"
date: "4/3/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

```{r}
library(shiny)
```



```{r}
job <- read_csv("https://github.com/hbnarayanan/stat479finalproject/raw/main/hr_analytics.csv")
```


```{r}
ui <- fluidPage(
  titlePanel("HR Attrition Analysis of Categorical Variables"),
selectInput("var1", "First Variable", colnames(job)[c(3,5,7,8,11,12,14,15,16,17,18,23,25,26,28,30,31)]),
selectInput("facet", "Facet By", colnames(job)[c(5,3,7,8,11,12,14,15,16,17,18,23,25,26,28,30,31)]),
  plotlyOutput("barplot")
  
  
)




server <- function(input, output) {

  
output$barplot <- renderPlotly({
  job %>% 
   # count(.data[[input$var1]], .data[[input$facet]],Attrition) %>% 
    group_by(.data[[input$var1]], .data[[input$facet]],Attrition) %>%
  summarise(n = n()) %>%
  mutate(freq = n / sum(n)) %>%
ggplot() +
geom_bar(aes(x=.data[[input$var1]],y=freq,fill=Attrition),stat="identity")+
  theme(axis.text.x = element_text(angle = 45, hjust=1))+
      facet_grid(~.data[[input$facet]])+
    labs(title = paste0("Frequency of Attrition in ", input$var1, " faceted by ", input$facet),x=paste0(input$var1),y="Attrition Frequency") 
})
  

  
  
}



shinyApp(ui, server)
```



